# 6.2 矩阵

矩阵是由数字元素组成的、遵循一定运算法则的数组。下面的数组有两行三列：

$$
\begin{bmatrix}
1.7 & -1.2 & 4.2 \\
3.0 & 4.5 & -7.2 \\
\end{bmatrix}
$$

矩阵在计算机图形学中有很多用处，如进行空间变换等。在讨论中， 我们假设矩阵的元素都是实数。本章会介绍矩阵的运算和方阵（即行数和列数相同的矩阵）对应的行列式。

## 6.2.1 Matrix Arithmetic 矩阵运算

一个矩阵和一个常数相乘，等于这个矩阵中每个元素与这个常数相乘，如：

$$
2 \left[\begin{matrix}
1 & -4 \\
3 & 2
\end{matrix}\right]
= \left[\begin{matrix}
2 & -8 \\
6 & 4
\end{matrix}\right]
$$

矩阵的加法就是矩阵的每个元素进行相加：

$$
\left[ \begin{matrix}
1 & -4 \\
3 & 2
\end{matrix} \right]
+ \left[\begin{matrix}
2 & 2 \\
2 & 2
\end{matrix} \right]
= \left[\begin{matrix}
3 & -2 \\
5 & 4
\end{matrix}\right]
$$

对矩阵乘法，我们将第一个矩阵的每一行与第二个矩阵的列进行“相乘”：

$$
\left[ \begin{matrix}
a_{11}&\cdots& a_{1m} \\
\vdots&\ &\vdots \\
\hline a_{i1}&\cdots&a_{im} \\
\hline \vdots&\ &\vdots \\
a_{r1}&\cdots& a_{rm} \\
\end{matrix} \right]
\left[ \begin{matrix} \begin{array}{cc|c|cc}
b_{11} & \cdots & b_{1j} & \cdots & b_{1c} \\
\vdots & \  & \vdots & \  & \vdots \\
b_{m1} & \cdots & b_{mj} & \cdots & b_{mc} \\
\end{array} \end{matrix} \right] =
\left[ \begin{matrix}
p_{11} & \cdots & p_{1j} & \cdots&p_{1c} \\
\vdots & \ & \vdots & \  & \vdots \\
p_{i1} & \cdots& \boxed{p_{ij}} & \cdots & p_{ic} \\
\vdots & \ &\vdots & \ & \vdots \\
p_{r1} & \cdots & p_{rj} &  \cdots & p_{rc} \\
\end{matrix} \right].
$$

其中，元素$p_{ij}$的计算过程如下：

$$
p_{ij} = a_{i1}b_{1j} + a_{i2}b_{2j} + \cdots + a_{im}b_{mj}. \tag{6.2}
$$

只有当左侧矩阵的列数等于右侧矩阵的行数时，才可以得到两个矩阵的乘积。例如：

$$
\left[ \begin{matrix}
0 & 1 \\
2 & 3 \\
4 & 5 \end{matrix} \right]
\left[ \begin{matrix}
6 & 7 & 8 & 9 \\
0 & 1 & 2 & 3
\end{matrix} \right]
= \left[ \begin{matrix}
0 & 1 & 2 & 3 \\
12 & 17 & 22 & 27 \\
24 & 33 & 42 & 51
\end{matrix} \right].
$$

在大多数情况下，矩阵乘法是不可交换的：

$$
\bf{AB} \neq \bf{BA}. \tag{6.3}
$$

同样，即使$\bf{AB} = \bf{AC}$，也不能导出$\bold{B} = \bold{C}$。但幸运的是，矩阵乘法是满足结合律和分配律的：

$$
(\bold{AB})\bold{C} = \bold{A}(\bold{BC}) \\
\bold{A}(\bold{B} + \bold{C}) = \bold{AB} + \bold{AC} \\ 
(\bold{A} + \bold{B})\bold{C} = \bold{AC} + \bold{BC}
$$

## 6.2.2 Operations on Matrices 矩阵运算

我们需要一个模拟实数倒数的矩阵。我们知道实数$x$的到时是$1/x$，实数$x$和它的倒数的乘积是1。我们需要一个矩阵$\mathbf{I}$，并将其视为“矩阵一”。这样的矩阵只能是方阵，并被称为*单位矩阵*。例如，4×4的单位阵是：

$$
\mathbf{I} = \left[\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
\end{matrix} \right].
$$

矩阵$\bold{A}$的*逆矩阵*是$\bold{A}^{-1}$，同时$\bold{A}\bold{A}^{-1} = \bold{I}$。例如：

$$
\left[\begin{matrix}
1 & 2 \\
3 & 4
\end{matrix}\right]^{-1} = 
\left[\begin{matrix}
-2.0 & 1.0 \\
1.5 & -0.5
\end{matrix}\right] ,由于 
\left[\begin{matrix}
1 & 2 \\
3 & 4
\end{matrix}\right]
\left[\begin{matrix}
-2.0 & 1.0 \\
1.5 & -0.5
\end{matrix}\right] = 
\left[\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}\right].
$$

矩阵$\bold{A}^{-1}$的逆矩阵是$\bold{A}$。所以$\bold{A}\bold{A}^{-1} = \bold{A}^{-1}\bold{A} = \bold{I}$。两个矩阵的乘积的逆是两个矩阵的逆的逆序的乘积：

$$
(\bold{AB})^{-1} = \bold{B}^{-1}\bold{A}^{-1}. \tag{6.4}
$$

我们将在6.3节再讨论逆的计算问题。

$\bold{A}$的*转置*矩阵$\bold{A}^T$和$\bold{A}$具有相同个元素，只不过将行和列进行了调换。如果我们将$\bold{A}^T$的元素标记为$a'_{ij}$，则$a_{ij} = a'_{ji}$。

例如，

$$
\left[ \begin{matrix} 1 & 2 \\
3 & 4 \\
5 & 6 \end{matrix} \right]^T = \left[ \begin{matrix}
1 & 3 & 5 \\
2 & 4 & 6
\end{matrix} \right]
$$
两个矩阵转置的乘积与等式(6.4)相同的规则：


$$
(\bold{AB})^T = \bold{B}^T\bold{A}^T .
$$
方阵的行列式可以简化为一系列列向量组成的矩阵。有几个和行列式相关的性质与上述讨论的矩阵的操作相关，我们将这些性质列在下面：

$$
|\bold{AB}| = |\bold{A}||\bold{B}|, \tag{6.5}
$$

$$
|\bold{A}^{-1}| = \frac{1}{|\bold{A}|}, \tag{6.6}
$$

$$
|\bold{A}^T| = |\bold{A}|. \tag{6.7}
$$

## 6.2.3 矩阵形式的向量操作

在图形学中，我们使用方阵来对矩阵形式的向量进行变换。例如，要将二维向量$\boldsymbol{a} = (x_a, y_a)$绕原点旋转90°得到向量$\boldsymbol{a}' = (-y_a, x_a)$，你可以使用一个2×2的矩阵与*列向量*形式的2×1矩阵进行相乘来完成。以矩阵形式进行操作便是：

$$
\left[\begin{matrix} 
0 & -1 \\
1 & 0
\end{matrix}\right]
\left[\begin{matrix}
x_a \\
y_a 
\end{matrix}\right]
=\left[\begin{matrix} 
-y_a \\
x_a 
\end{matrix}\right]
$$

我们可以通过在这个矩阵的转置的左边乘以一个行向量(左乘))来得到相同的结果：

$$
\left[\begin{matrix}
x_a & y_a 
\end{matrix}\right]
\left[\begin{matrix} 
0 & 1 \\ 
-1 & 0
\end{matrix}\right]
=\left[\begin{matrix} 
-y_a & x_a 
\end{matrix}\right]
$$

现在，使用列向量的右乘已经成为既定的标准，但是在一些老的书籍和系统中，你还会遇到行向量和左乘。这其中的唯一区别就是需要将其转换矩阵替换为转置矩阵。

我们还可以使用矩阵形式对向量进行编码运算。如果我们将点乘的结果看作一个1×1矩阵，它可以写成：
$$
\bold{a}\cdot\bold{b} = \bold{a}^T\bold{b}.
$$
假设我们将两个三维向量代入，则：
$$
\left[\begin{matrix}x_a & y_a & z_a\end{matrix}\right]
\left[\begin{matrix}
x_b \\
y_b \\
z_b
\end{matrix}\right] = \left[\begin{matrix}
x_ax_b + y_ay_b + z_az_b
\end{matrix}\right].
$$
向量的积是两个向量的*外积*，可以表示为左边的列向量与右边的行向量的乘积$\boldsymbol{ab}^T$。其结果是一个由$\boldsymbol{a}$中的一个元素与$\boldsymbol{b}$中对应元素的所有乘积对组成的矩阵。对于三维向量，即：
$$
\left[ \begin{matrix}
x_a \\
y_a \\
z_a
\end{matrix} \right]
\left[ \begin{matrix} 
x_b & y_b & z_b \end{matrix} \right]=
\left[ \begin{matrix} 
x_ax_b & x_ay_b & x_az_b \\
y_ax_b & y_ay_b & y_az_b \\
z_ax_b & z_ay_b & z_az_b 
\end{matrix} \right]
$$
